name: ROS CI - Build Specific Node

on: # rebuild any PRs and main branch changes
  pull_request:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    
    env:
      ROS_DISTRO: "noetic"
    
    steps:
      # Step 1: Checkout repository
      - name: Checkout repository
        uses: actions/checkout@v2

      # Step 2: Set up ROS environment
      - name: Setup ROS
        run: |
          sudo apt update -qq
          sudo apt install -y curl gnupg2 lsb-release
          sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
          curl -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | sudo apt-key add -
          sudo apt update -qq
          sudo apt install -y ros-noetic-desktop-full
          source /opt/ros/noetic/setup.bash
          # sudo apt install -y python-rosdep
          sudo rosdep init || true
          rosdep update
          rosdep install --from-paths src --ignore-src -r -y
          
      # Build using catkin_make (for ROS1)
      - name: Build the ROS node (ROS1)
        run: |
          source /opt/ros/noetic/setup.bash
          catkin_make --pkg guidance_planner



